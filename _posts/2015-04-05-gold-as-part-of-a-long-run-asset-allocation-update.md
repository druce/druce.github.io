---
id: 3310
title: Gold as Part of a Long-Run Asset Allocation (update)
date: 2015-04-05T22:51:38+00:00
author: Druce Vertes, CFA
layout: post
guid: /?p=3310
permalink: /2015/04/gold-as-part-of-a-long-run-asset-allocation-update/
post-views:
  - "3478"
dsq_thread_id:
  - "3657942809"
categories:
  - Uncategorized
---
_You have to choose between trusting to the natural stability of gold and the natural stability of the honesty and intelligence of the members of the government. And, with due respect to these gentlemen, I advise you, as long as the capitalist system lasts, to vote for gold. &#8211; George Bernard Shaw_

Here&#8217;s a quick update of a post I did a couple of years back on [Gold as part of a long run asset allocation](/2012/01/gold-as-part-of-long-run-asset-allocation/). Gold hasn&#8217;t fared too well since then.

Let&#8217;s look at four asset classes from 1928-2014: US stocks (ie S&P), medium-term Treasurys (ie 10-year), T-bills, and gold. (Would love to do international developed, emerging, TIPS, real estate, but data doesn&#8217;t go back that far.)

Let&#8217;s adjust returns for inflation. Here&#8217;s are the historical mean annual real returns and standard deviations of annual returns.

<table>
  <tr>
    <td>
    </td>
    
    <td>
    </td>
    
    <td>
      Real Return
    </td>
    
    <td>
    </td>
    
    <td>
      Real Risk
    </td>
  </tr>
  
  <tr>
    <td>
      Stocks
    </td>
    
    <td>
    </td>
    
    <td>
      8.3%
    </td>
    
    <td>
    </td>
    
    <td>
      19.8%
    </td>
  </tr>
  
  <tr>
    <td>
      Bonds
    </td>
    
    <td>
    </td>
    
    <td>
      2.3%
    </td>
    
    <td>
    </td>
    
    <td>
      8.8%
    </td>
  </tr>
  
  <tr>
    <td>
      Bills
    </td>
    
    <td>
    </td>
    
    <td>
      0.5%
    </td>
    
    <td>
    </td>
    
    <td>
      3.9%
    </td>
  </tr>
  
  <td>
    Gold
  </td>
  
  <td>
  </td>
  
  <td>
    3.2%
  </td>
  
  <td>
  </td>
  
  <td>
    18.8%
  </td></tr> 
  
  <tr>
    <td>
    </td>
    
    <td>
    </td>
  </tr>
</table>

Let&#8217;s compute the efficient frontier. The left-most point is the minimum-volatility portfolio. The right-most point is the max-return portfolio, which is 100% stocks. We compute the minimum-volatility portfolio for return levels between those two, and plot the resulting efficient frontier.

[<img src="/uploads/2015/04/Rplot10.png" alt="Efficient Frontier, 1928-2014" width="480" height="352" class="aligncenter size-full wp-image-3344" srcset="/uploads/2015/04/Rplot10.png 480w, /uploads/2015/04/Rplot10-300x220.png 300w" sizes="(max-width: 480px) 100vw, 480px" />](/uploads/2015/04/Rplot10.png)</p> 

What is the composition of the portfolio at each point on the efficient frontier? We plot a transition map showing that as you start from the minimum-volatility portfolio with about 1% real return and 2% volatility, composed of mostly T-bills, with some stocks and gold, and move toward the maximum-return portfolio, you add more and more stocks, but always include some gold.

<p style="text-align: center;">
  <strong>Transition map, 1926-2014</strong><br /> <a href="/uploads/2015/04/Rplot11.png"><img src="/uploads/2015/04/Rplot11.png" alt="Transition map" width="480" height="352" class="aligncenter size-full wp-image-3345" srcset="/uploads/2015/04/Rplot11.png 480w, /uploads/2015/04/Rplot11-300x220.png 300w" sizes="(max-width: 480px) 100vw, 480px" /></a>
</p>

Let&#8217;s try a few different eras.

****1946-2014, Post-war, since Bretton Woods:**  
** 

[<img src="/uploads/2015/04/Rplot12.png" alt="Efficient frontier" width="480" height="352" class="aligncenter size-full wp-image-3348" srcset="/uploads/2015/04/Rplot12.png 480w, /uploads/2015/04/Rplot12-300x220.png 300w" sizes="(max-width: 480px) 100vw, 480px" />](/uploads/2015/04/Rplot12.png)

[<img src="/uploads/2015/04/Rplot13.png" alt="Transition map" width="480" height="352" class="aligncenter size-full wp-image-3349" srcset="/uploads/2015/04/Rplot13.png 480w, /uploads/2015/04/Rplot13-300x220.png 300w" sizes="(max-width: 480px) 100vw, 480px" />](/uploads/2015/04/Rplot13.png)  
&nbsp;

**1972-2010, Post-war, post-gold standard **(had to adjust the scale a little to get that gold data point on there):

[<img src="/uploads/2015/04/Rplot14.png" alt="Efficient frontier" width="480" height="352" class="aligncenter size-full wp-image-3351" srcset="/uploads/2015/04/Rplot14.png 480w, /uploads/2015/04/Rplot14-300x220.png 300w" sizes="(max-width: 480px) 100vw, 480px" />](/uploads/2015/04/Rplot14.png)

[<img src="/uploads/2015/04/Rplot15.png" alt="Transition map" width="480" height="352" class="aligncenter size-full wp-image-3352" srcset="/uploads/2015/04/Rplot15.png 480w, /uploads/2015/04/Rplot15-300x220.png 300w" sizes="(max-width: 480px) 100vw, 480px" />](/uploads/2015/04/Rplot15.png)  
&nbsp;

**1982-2014, era of disinflation:**

[<img src="/uploads/2015/04/Rplot16.png" alt="Efficient frontier" width="480" height="352" class="aligncenter size-full wp-image-3354" srcset="/uploads/2015/04/Rplot16.png 480w, /uploads/2015/04/Rplot16-300x220.png 300w" sizes="(max-width: 480px) 100vw, 480px" />](/uploads/2015/04/Rplot16.png)

[<img src="/uploads/2015/04/Rplot17.png" alt="Transition map" width="480" height="352" class="aligncenter size-full wp-image-3355" srcset="/uploads/2015/04/Rplot17.png 480w, /uploads/2015/04/Rplot17-300x220.png 300w" sizes="(max-width: 480px) 100vw, 480px" />](/uploads/2015/04/Rplot17.png)

What should one conclude? In most regimes gold was worth owning in the portfolio that gives the most return at a given risk level. The exception was the era of globalization and disinflation, where we had high returns from stocks coupled with disinflation. If you expect that to be the case, as it has been the last 30 years, gold doesn&#8217;t improve the longer time-frame, more risky portfolios, like a 70-30 portfolio. But over the varied regimes of the last 87 years, it was a hedge worth having. 

I say this as one who believes the gold bugs are useless, except for a chuckle. But central banks really want moderate inflation to solve the consumer debt/balance sheet problem. Deflation is anathema to them when everyone is up to their eyeballs in debt. 

The question of our time is whether QE/easing -> inflated asset values -> more debt -> consumer goods/services inflation -> solves debt and overinflated asset problem. 

Or QE/easing -> more debt -> deflation/no inflation -> even more precarious balance sheets -> financial crises and economic chaos. 

Either way, a little gold is a good hedge in a number of scenarios.

(See the whole [Bernanke/Summers/Piketty](http://www.washingtonpost.com/blogs/wonkblog/wp/2015/04/02/larry-summers-and-ben-bernanke-are-having-the-most-important-blog-fight-ever/) secular stagnation/robots debate, which I discussed a bit [here](/2015/02/can-you-have-robots-hoverboards-and-secular-stagnation/).) 

R code and data:

<div class="wp_codebox_msgheader wp_codebox_hide">
  <span class="right"><sup><a href="http://www.ericbess.com/ericblog/2008/03/03/wp-codebox/#examples" target="_blank" title="WP-CodeBox HowTo?"><span style="color: #99cc00">?</span></a></sup></span><span class="left"><a href="javascript:;" onclick="javascript:showCodeTxt('p3310code16'); return false;">View Code</a> RSPLUS</span>
  
  <div class="codebox_clear">
  </div>
</div>

<div class="wp_codebox">
  <table>
    <tr id="p331016">
      <td class="code" id="p3310code16">
        <pre class="rsplus" style="font-family:monospace;"><span style="color: #228B22;"># install.packages('quantmod')</span>
<span style="color: #228B22;"># require(quantmod)</span>
<span style="color: #228B22;"># install.packages('lpSolve')</span>
<a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/require.html"><span style="color: #0000FF; font-weight: bold;">require</span></a><span style="color: #080;">&#40;</span>lpSolve<span style="color: #080;">&#41;</span>
<span style="color: #228B22;"># install.packages('quadprog')</span>
<a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/require.html"><span style="color: #0000FF; font-weight: bold;">require</span></a><span style="color: #080;">&#40;</span>quadprog<span style="color: #080;">&#41;</span>
<span style="color: #228B22;"># install.packages('ggplot2')</span>
<a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/require.html"><span style="color: #0000FF; font-weight: bold;">require</span></a><span style="color: #080;">&#40;</span>ggplot2<span style="color: #080;">&#41;</span>
<a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/require.html"><span style="color: #0000FF; font-weight: bold;">require</span></a><span style="color: #080;">&#40;</span><span style="color: #0000FF; font-weight: bold;">reshape</span><span style="color: #080;">&#41;</span>
&nbsp;
<span style="color: #228B22;"># define functions</span>
&nbsp;
<span style="color: #228B22;">#################################################################</span>
<span style="color: #228B22;"># use linear programming to find maximum return portfolio (100% highest return asset)</span>
<span style="color: #228B22;">#################################################################</span>
&nbsp;
runlp <span style="color: #080;">&lt;-</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/function.html"><span style="color: #0000FF; font-weight: bold;">function</span></a> <span style="color: #080;">&#40;</span> returns <span style="color: #080;">&#41;</span>
<span style="color: #080;">&#123;</span>
&nbsp;
	<span style="color: #228B22;"># find maximum return portfolio (rightmost point of efficient frontier)</span>
	<span style="color: #228B22;"># will be 100% of highest return asset</span>
	<span style="color: #228B22;"># maximize</span>
	<span style="color: #228B22;">#   w1 * stocks return +w2 *bills +w3*bonds + w4 * gold</span>
	<span style="color: #228B22;">#   subject to 0 &lt;= w &lt;= 1  for each w</span>
	<span style="color: #228B22;"># will pick highest return asset with w=1</span>
	<span style="color: #228B22;"># skipping &gt;0 constraint, no negative return assets, so not binding</span>
&nbsp;
	opt.<span style="">objective</span> <span style="color: #080;">&lt;-</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/apply.html"><span style="color: #0000FF; font-weight: bold;">apply</span></a><span style="color: #080;">&#40;</span>returns, <span style="color: #ff0000;">2</span>, <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/mean.html"><span style="color: #0000FF; font-weight: bold;">mean</span></a><span style="color: #080;">&#41;</span>
&nbsp;
	<span style="color: #228B22;"># should use length(objective) to populate matrix</span>
	nAssets <span style="color: #080;">&lt;-</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/length.html"><span style="color: #0000FF; font-weight: bold;">length</span></a><span style="color: #080;">&#40;</span>returns<span style="color: #080;">&#41;</span>
	ones <span style="color: #080;">=</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/rep.html"><span style="color: #0000FF; font-weight: bold;">rep</span></a> <span style="color: #080;">&#40;</span><span style="color: #ff0000;">1</span>, nAssets<span style="color: #080;">&#41;</span>
	zeros <span style="color: #080;">=</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/rep.html"><span style="color: #0000FF; font-weight: bold;">rep</span></a> <span style="color: #080;">&#40;</span><span style="color: #ff0000;"></span>, nAssets<span style="color: #080;">&#41;</span>
&nbsp;
	<span style="color: #228B22;"># constrain sum of weights to 1</span>
	constraintlist <span style="color: #080;">=</span> ones
	operatorlist <span style="color: #080;">=</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span><span style="color: #ff0000;">"="</span><span style="color: #080;">&#41;</span>
	rhslist <span style="color: #080;">=</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span><span style="color: #ff0000;">1</span><span style="color: #080;">&#41;</span>
&nbsp;
	<span style="color: #228B22;"># constrain each weight &gt;= 0</span>
	<a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/for.html"><span style="color: #0000FF; font-weight: bold;">for</span></a><span style="color: #080;">&#40;</span>i <span style="color: #0000FF; font-weight: bold;">in</span> <span style="color: #ff0000;">1</span><span style="color: #080;">:</span>nAssets<span style="color: #080;">&#41;</span> <span style="color: #080;">&#123;</span>
		newconstraint <span style="color: #080;">=</span> zeros
		newconstraint<span style="color: #080;">&#91;</span>i<span style="color: #080;">&#93;</span><span style="color: #080;">=</span><span style="color: #ff0000;">1</span>
		constraintlist <span style="color: #080;">=</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span>constraintlist, newconstraint<span style="color: #080;">&#41;</span>
		operatorlist <span style="color: #080;">=</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span>operatorlist, <span style="color: #ff0000;">"&gt;="</span><span style="color: #080;">&#41;</span>
		rhslist <span style="color: #080;">=</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span>rhslist, <span style="color: #ff0000;"></span><span style="color: #080;">&#41;</span>
	<span style="color: #080;">&#125;</span>
&nbsp;
<span style="color: #228B22;">#	Example</span>
<span style="color: #228B22;">#	opt.constraints &lt;- matrix (c(1, 1, 1, 1,  # constrain sum of weights to 1</span>
<span style="color: #228B22;">#							 1, 0, 0, 0,  # constrain w1 &lt;= 1</span>
<span style="color: #228B22;">#							 0, 1, 0, 0,  # constrain w2 &lt;= 1</span>
<span style="color: #228B22;">#							 0, 0, 1, 0,  # constrain w3 &lt;= 1</span>
<span style="color: #228B22;">#							 0, 0, 0, 1)  # constrain w4 &lt;= 1</span>
<span style="color: #228B22;">#						   , nrow=5, byrow=TRUE)</span>
&nbsp;
	opt.<span style="">constraints</span> <span style="color: #080;">&lt;-</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/matrix.html"><span style="color: #0000FF; font-weight: bold;">matrix</span></a> <span style="color: #080;">&#40;</span>constraintlist, <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/nrow.html"><span style="color: #0000FF; font-weight: bold;">nrow</span></a><span style="color: #080;">=</span>nAssets<span style="color: #080;">+</span><span style="color: #ff0000;">1</span>, byrow<span style="color: #080;">=</span>TRUE<span style="color: #080;">&#41;</span>
	opt.<span style="">operator</span> <span style="color: #080;">&lt;-</span> operatorlist
	opt.<span style="">rhs</span> <span style="color: #080;">&lt;-</span> rhslist
	opt.<span style="">dir</span><span style="color: #080;">=</span><span style="color: #ff0000;">"max"</span>
&nbsp;
	tmpsolution <span style="color: #080;">=</span> lp <span style="color: #080;">&#40;</span>direction <span style="color: #080;">=</span> opt.<span style="">dir</span>,
	opt.<span style="">objective</span>,
	opt.<span style="">constraints</span>,
	opt.<span style="">operator</span>,
	opt.<span style="">rhs</span><span style="color: #080;">&#41;</span>
&nbsp;
	sol<span style="color: #080;">=</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span><span style="color: #080;">&#41;</span>
	<span style="color: #228B22;"># portfolio weights for max return portfolio</span>
	sol$wts<span style="color: #080;">=</span>tmpsolution$solution
	<span style="color: #228B22;"># return for max return portfolio</span>
	sol$ret<span style="color: #080;">=</span>tmpsolution$objval
	<span style="color: #228B22;"># compute return covariance matrix to determine volatility of this portfolio</span>
	sol$covmatrix <span style="color: #080;">=</span> <span style="color: #0000FF; font-weight: bold;">cov</span><span style="color: #080;">&#40;</span>returns, use <span style="color: #080;">=</span> <span style="color: #ff0000;">'complete.obs'</span>, method <span style="color: #080;">=</span> <span style="color: #ff0000;">'pearson'</span><span style="color: #080;">&#41;</span>
	<span style="color: #228B22;"># multiply weights x covariances x weights, gives variance</span>
	sol$var <span style="color: #080;">=</span> sol$wts <span style="color: #080;">%*%</span> sol$covmatrix <span style="color: #080;">%*%</span> sol$wts
	<span style="color: #228B22;"># square root gives standard deviation (volatility)</span>
	sol$vol <span style="color: #080;">=</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/sqrt.html"><span style="color: #0000FF; font-weight: bold;">sqrt</span></a><span style="color: #080;">&#40;</span>sol$var<span style="color: #080;">&#41;</span>
&nbsp;
	<a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/return.html"><span style="color: #0000FF; font-weight: bold;">return</span></a> <span style="color: #080;">&#40;</span>sol<span style="color: #080;">&#41;</span>
<span style="color: #080;">&#125;</span>
&nbsp;
runqp <span style="color: #080;">&lt;-</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/function.html"><span style="color: #0000FF; font-weight: bold;">function</span></a> <span style="color: #080;">&#40;</span> returns, hurdle<span style="color: #080;">=</span><span style="color: #ff0000;"></span> <span style="color: #080;">&#41;</span>
<span style="color: #080;">&#123;</span>
<span style="color: #228B22;">#################################################################</span>
<span style="color: #228B22;"># find minimum volatility portfolio</span>
<span style="color: #228B22;">#################################################################</span>
&nbsp;
<span style="color: #228B22;"># minimize variance:  w %*% covmatrix %*% t(w)</span>
<span style="color: #228B22;"># subject to sum of ws = 1</span>
<span style="color: #228B22;"># subject to each w &gt;= 0</span>
<span style="color: #228B22;"># subject to each return &gt;= hurdle</span>
&nbsp;
<span style="color: #228B22;"># solution.minvol &lt;- solve.QP(covmatrix, zeros, t(opt.constraints), opt.rhs, meq = opt.meq)</span>
<span style="color: #228B22;"># first 2 parameters covmatrix, zeros define function to be minimized</span>
<span style="color: #228B22;"># if zeros is all 0s, the function minimized ends up equal to port variance / 2</span>
<span style="color: #228B22;"># opt.constraints is the left hand side of the constraints, ie the cs in</span>
<span style="color: #228B22;"># c1 w1 + c2 w2 ... + cn wn = K</span>
<span style="color: #228B22;"># opt.rhs is the Ks in the above equation</span>
<span style="color: #228B22;"># meq means the first meq rows are 'equals' constraints, remainder are &gt;= constraints</span>
<span style="color: #228B22;"># if you want to do a &lt;= constraint, multiply by -1 to make it a &gt;= constraint</span>
<span style="color: #228B22;"># does not appear to accept 0 RHS, so we make it a tiny number&gt; 0</span>
&nbsp;
	<span style="color: #228B22;"># compute expected returns</span>
	meanreturns <span style="color: #080;">&lt;-</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/apply.html"><span style="color: #0000FF; font-weight: bold;">apply</span></a><span style="color: #080;">&#40;</span>returns, <span style="color: #ff0000;">2</span>, <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/mean.html"><span style="color: #0000FF; font-weight: bold;">mean</span></a><span style="color: #080;">&#41;</span>
&nbsp;
	<span style="color: #228B22;"># compute covariance matrix</span>
	covmatrix <span style="color: #080;">=</span> <span style="color: #0000FF; font-weight: bold;">cov</span><span style="color: #080;">&#40;</span>returns, use <span style="color: #080;">=</span> <span style="color: #ff0000;">'complete.obs'</span>, method <span style="color: #080;">=</span> <span style="color: #ff0000;">'pearson'</span><span style="color: #080;">&#41;</span>
&nbsp;
	nAssets <span style="color: #080;">&lt;-</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/length.html"><span style="color: #0000FF; font-weight: bold;">length</span></a><span style="color: #080;">&#40;</span>returns<span style="color: #080;">&#41;</span>
	nObs <span style="color: #080;">&lt;-</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/length.html"><span style="color: #0000FF; font-weight: bold;">length</span></a><span style="color: #080;">&#40;</span>returns$stocks<span style="color: #080;">&#41;</span>
	ones <span style="color: #080;">=</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/rep.html"><span style="color: #0000FF; font-weight: bold;">rep</span></a> <span style="color: #080;">&#40;</span><span style="color: #ff0000;">1</span>, nAssets<span style="color: #080;">&#41;</span>
	zeros <span style="color: #080;">=</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/rep.html"><span style="color: #0000FF; font-weight: bold;">rep</span></a> <span style="color: #080;">&#40;</span><span style="color: #ff0000;"></span>, nAssets<span style="color: #080;">&#41;</span>
&nbsp;
	<span style="color: #228B22;"># constrain sum of weights to 1</span>
	constraintlist <span style="color: #080;">=</span> ones
	rhslist <span style="color: #080;">=</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span><span style="color: #ff0000;">1</span><span style="color: #080;">&#41;</span>
&nbsp;
	<span style="color: #228B22;"># constrain each weight &gt;= 0</span>
	<a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/for.html"><span style="color: #0000FF; font-weight: bold;">for</span></a><span style="color: #080;">&#40;</span>i <span style="color: #0000FF; font-weight: bold;">in</span> <span style="color: #ff0000;">1</span><span style="color: #080;">:</span>nAssets<span style="color: #080;">&#41;</span> <span style="color: #080;">&#123;</span>
		newconstraint <span style="color: #080;">=</span> zeros
		newconstraint<span style="color: #080;">&#91;</span>i<span style="color: #080;">&#93;</span><span style="color: #080;">=</span><span style="color: #ff0000;">1</span>
		constraintlist <span style="color: #080;">=</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span>constraintlist, newconstraint<span style="color: #080;">&#41;</span>
		rhslist <span style="color: #080;">=</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span>rhslist, <span style="color: #ff0000;"></span><span style="color: #080;">&#41;</span>
	<span style="color: #080;">&#125;</span>
&nbsp;
	<span style="color: #228B22;"># constrain return &gt;= hurdle</span>
	constraintlist <span style="color: #080;">=</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span>constraintlist, meanreturns<span style="color: #080;">&#41;</span>
	rhslist <span style="color: #080;">=</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span>rhslist, hurdle<span style="color: #080;">&#41;</span>
&nbsp;
	<span style="color: #228B22;"># example</span>
	<span style="color: #228B22;"># opt.constraints &lt;- matrix (c(1, 1, 1, 1,   # sum of weights =1</span>
	<span style="color: #228B22;">#							 1, 0, 0, 0,   # w1 &gt;= 0</span>
	<span style="color: #228B22;">#							 0, 1, 0, 0,   # w2 &gt;= 0</span>
	<span style="color: #228B22;">#							 0, 0, 1, 0,   # w3 &gt;= 0</span>
	<span style="color: #228B22;">#							 0, 0, 0, 1)   # w4 &gt;= 0</span>
&nbsp;
	<span style="color: #228B22;">#						   , nrow=5, byrow=TRUE)</span>
	<span style="color: #228B22;"># opt.rhs &lt;- matrix(c(1, 0.000001, 0.000001, 0.000001, 0.000001))</span>
	<span style="color: #228B22;"># opt.constraints = rbind(opt.constraints, meanreturns)</span>
	<span style="color: #228B22;"># opt.rhs=rbind(opt.rhs, hurdle)</span>
&nbsp;
	opt.<span style="">constraints</span> <span style="color: #080;">&lt;-</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/matrix.html"><span style="color: #0000FF; font-weight: bold;">matrix</span></a> <span style="color: #080;">&#40;</span>constraintlist, <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/nrow.html"><span style="color: #0000FF; font-weight: bold;">nrow</span></a><span style="color: #080;">=</span>nAssets<span style="color: #080;">+</span><span style="color: #ff0000;">2</span>, byrow<span style="color: #080;">=</span>TRUE<span style="color: #080;">&#41;</span>
	opt.<span style="">rhs</span> <span style="color: #080;">&lt;-</span> opt.<span style="">rhs</span> <span style="color: #080;">&lt;-</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/matrix.html"><span style="color: #0000FF; font-weight: bold;">matrix</span></a><span style="color: #080;">&#40;</span>rhslist<span style="color: #080;">&#41;</span>
	opt.<span style="">meq</span> <span style="color: #080;">&lt;-</span> <span style="color: #ff0000;">1</span>  <span style="color: #228B22;"># first constraint is '=', rest are '&gt;='</span>
&nbsp;
	zeros <span style="color: #080;">&lt;-</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/array.html"><span style="color: #0000FF; font-weight: bold;">array</span></a><span style="color: #080;">&#40;</span><span style="color: #ff0000;"></span>, <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/dim.html"><span style="color: #0000FF; font-weight: bold;">dim</span></a> <span style="color: #080;">=</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span>nAssets,<span style="color: #ff0000;">1</span><span style="color: #080;">&#41;</span><span style="color: #080;">&#41;</span>
	tmpsolution <span style="color: #080;">&lt;-</span> solve.<span style="">QP</span><span style="color: #080;">&#40;</span>covmatrix, zeros, <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/t.html"><span style="color: #0000FF; font-weight: bold;">t</span></a><span style="color: #080;">&#40;</span>opt.<span style="">constraints</span><span style="color: #080;">&#41;</span>, opt.<span style="">rhs</span>, meq <span style="color: #080;">=</span> opt.<span style="">meq</span><span style="color: #080;">&#41;</span>
&nbsp;
	sol<span style="color: #080;">=</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span><span style="color: #080;">&#41;</span>
	sol$wts <span style="color: #080;">=</span> tmpsolution$solution
	sol$var <span style="color: #080;">=</span> tmpsolution$value <span style="color: #080;">*</span><span style="color: #ff0000;">2</span>
	sol$ret <span style="color: #080;">=</span> meanreturns <span style="color: #080;">%*%</span> sol$wts
	sol$vol <span style="color: #080;">=</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/sqrt.html"><span style="color: #0000FF; font-weight: bold;">sqrt</span></a><span style="color: #080;">&#40;</span>sol$var<span style="color: #080;">&#41;</span>
&nbsp;
	<a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/return.html"><span style="color: #0000FF; font-weight: bold;">return</span></a><span style="color: #080;">&#40;</span>sol<span style="color: #080;">&#41;</span>
<span style="color: #080;">&#125;</span>
&nbsp;
loopqp <span style="color: #080;">&lt;-</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/function.html"><span style="color: #0000FF; font-weight: bold;">function</span></a> <span style="color: #080;">&#40;</span>minvol, maxret, numtrials<span style="color: #080;">&#41;</span>
<span style="color: #080;">&#123;</span>
&nbsp;
	<span style="color: #228B22;">#################################################################</span>
	<span style="color: #228B22;"># loop and run a minimum volatility optimization for each return level from 2-49</span>
	<span style="color: #228B22;">#################################################################</span>
&nbsp;
	<span style="color: #228B22;"># put minreturn portfolio in return series for min return, index =1</span>
	out.<span style="">ret</span><span style="color: #080;">=</span><a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span>minvol$ret<span style="color: #080;">&#41;</span>
	out.<span style="">vol</span><span style="color: #080;">=</span><a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span>minvol$vol<span style="color: #080;">&#41;</span>
	out.<span style="">stocks</span><span style="color: #080;">=</span><a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span>minvol$wts<span style="color: #080;">&#91;</span><span style="color: #ff0000;">1</span><span style="color: #080;">&#93;</span><span style="color: #080;">&#41;</span>
	out.<span style="">bills</span><span style="color: #080;">=</span><a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span>minvol$wts<span style="color: #080;">&#91;</span><span style="color: #ff0000;">2</span><span style="color: #080;">&#93;</span><span style="color: #080;">&#41;</span>
	out.<span style="">bonds</span><span style="color: #080;">=</span><a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span>minvol$wts<span style="color: #080;">&#91;</span><span style="color: #ff0000;">3</span><span style="color: #080;">&#93;</span><span style="color: #080;">&#41;</span>
	out.<span style="">gold</span><span style="color: #080;">=</span><a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span>minvol$wts<span style="color: #080;">&#91;</span><span style="color: #ff0000;">4</span><span style="color: #080;">&#93;</span><span style="color: #080;">&#41;</span>
&nbsp;
	lowreturn <span style="color: #080;">&lt;-</span> minvol$ret
	highreturn <span style="color: #080;">&lt;-</span> maxret$ret
	minreturns <span style="color: #080;">&lt;-</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/seq.html"><span style="color: #0000FF; font-weight: bold;">seq</span></a><span style="color: #080;">&#40;</span>lowreturn, highreturn, length.<span style="">out</span><span style="color: #080;">=</span>numtrials<span style="color: #080;">&#41;</span>
&nbsp;
	<a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/for.html"><span style="color: #0000FF; font-weight: bold;">for</span></a><span style="color: #080;">&#40;</span>i <span style="color: #0000FF; font-weight: bold;">in</span> <span style="color: #ff0000;">2</span><span style="color: #080;">:</span><span style="color: #080;">&#40;</span><a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/length.html"><span style="color: #0000FF; font-weight: bold;">length</span></a><span style="color: #080;">&#40;</span>minreturns<span style="color: #080;">&#41;</span> <span style="color: #080;">-</span> <span style="color: #ff0000;">1</span><span style="color: #080;">&#41;</span><span style="color: #080;">&#41;</span> <span style="color: #080;">&#123;</span>
		tmpsol <span style="color: #080;">&lt;-</span> runqp<span style="color: #080;">&#40;</span>freal,minreturns<span style="color: #080;">&#91;</span>i<span style="color: #080;">&#93;</span><span style="color: #080;">&#41;</span>
		tmp.<span style="">wts</span> <span style="color: #080;">=</span> tmpsol$wts
		tmp.<span style="">var</span> <span style="color: #080;">=</span> tmpsol$var
&nbsp;
		out.<span style="">ret</span><span style="color: #080;">&#91;</span>i<span style="color: #080;">&#93;</span> <span style="color: #080;">=</span> realreturns <span style="color: #080;">%*%</span> tmp.<span style="">wts</span>
		out.<span style="">vol</span><span style="color: #080;">&#91;</span>i<span style="color: #080;">&#93;</span> <span style="color: #080;">=</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/sqrt.html"><span style="color: #0000FF; font-weight: bold;">sqrt</span></a><span style="color: #080;">&#40;</span>tmp.<span style="">var</span><span style="color: #080;">&#41;</span>
		out.<span style="">stocks</span><span style="color: #080;">&#91;</span>i<span style="color: #080;">&#93;</span><span style="color: #080;">=</span>tmp.<span style="">wts</span><span style="color: #080;">&#91;</span><span style="color: #ff0000;">1</span><span style="color: #080;">&#93;</span>
		out.<span style="">bills</span><span style="color: #080;">&#91;</span>i<span style="color: #080;">&#93;</span><span style="color: #080;">=</span>tmp.<span style="">wts</span><span style="color: #080;">&#91;</span><span style="color: #ff0000;">2</span><span style="color: #080;">&#93;</span>
		out.<span style="">bonds</span><span style="color: #080;">&#91;</span>i<span style="color: #080;">&#93;</span><span style="color: #080;">=</span>tmp.<span style="">wts</span><span style="color: #080;">&#91;</span><span style="color: #ff0000;">3</span><span style="color: #080;">&#93;</span>
		out.<span style="">gold</span><span style="color: #080;">&#91;</span>i<span style="color: #080;">&#93;</span><span style="color: #080;">=</span>tmp.<span style="">wts</span><span style="color: #080;">&#91;</span><span style="color: #ff0000;">4</span><span style="color: #080;">&#93;</span>
	<span style="color: #080;">&#125;</span>
&nbsp;
<span style="color: #228B22;"># put maxreturn portfolio in return series for max return</span>
	out.<span style="">ret</span><span style="color: #080;">&#91;</span>numtrials<span style="color: #080;">&#93;</span><span style="color: #080;">=</span><a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span>maxret$ret<span style="color: #080;">&#41;</span>
	out.<span style="">vol</span><span style="color: #080;">&#91;</span>numtrials<span style="color: #080;">&#93;</span><span style="color: #080;">=</span><a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span>maxret$vol<span style="color: #080;">&#41;</span>
	out.<span style="">stocks</span><span style="color: #080;">&#91;</span>numtrials<span style="color: #080;">&#93;</span><span style="color: #080;">=</span><a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span>maxret$wts<span style="color: #080;">&#91;</span><span style="color: #ff0000;">1</span><span style="color: #080;">&#93;</span><span style="color: #080;">&#41;</span>
	out.<span style="">bills</span><span style="color: #080;">&#91;</span>numtrials<span style="color: #080;">&#93;</span><span style="color: #080;">=</span><a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span>maxret$wts<span style="color: #080;">&#91;</span><span style="color: #ff0000;">2</span><span style="color: #080;">&#93;</span><span style="color: #080;">&#41;</span>
	out.<span style="">bonds</span><span style="color: #080;">&#91;</span>numtrials<span style="color: #080;">&#93;</span><span style="color: #080;">=</span><a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span>maxret$wts<span style="color: #080;">&#91;</span><span style="color: #ff0000;">3</span><span style="color: #080;">&#93;</span><span style="color: #080;">&#41;</span>
	out.<span style="">gold</span><span style="color: #080;">&#91;</span>numtrials<span style="color: #080;">&#93;</span><span style="color: #080;">=</span><a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span>maxret$wts<span style="color: #080;">&#91;</span><span style="color: #ff0000;">4</span><span style="color: #080;">&#93;</span><span style="color: #080;">&#41;</span>
&nbsp;
	efrontier<span style="color: #080;">=</span><a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/data.frame.html"><span style="color: #0000FF; font-weight: bold;">data.<span style="">frame</span></span></a><span style="color: #080;">&#40;</span>out.<span style="">ret</span><span style="color: #080;">*</span><span style="color: #ff0000;">100</span><span style="color: #080;">&#41;</span>
	efrontier$vol<span style="color: #080;">=</span>out.<span style="">vol</span><span style="color: #080;">*</span><span style="color: #ff0000;">100</span>
	efrontier$stocks<span style="color: #080;">=</span>out.<span style="">stocks</span><span style="color: #080;">*</span><span style="color: #ff0000;">100</span>
	efrontier$bills<span style="color: #080;">=</span>out.<span style="">bills</span><span style="color: #080;">*</span><span style="color: #ff0000;">100</span>
	efrontier$bonds<span style="color: #080;">=</span>out.<span style="">bonds</span><span style="color: #080;">*</span><span style="color: #ff0000;">100</span>
	efrontier$gold<span style="color: #080;">=</span>out.<span style="">gold</span><span style="color: #080;">*</span><span style="color: #ff0000;">100</span>
	<a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/names.html"><span style="color: #0000FF; font-weight: bold;">names</span></a><span style="color: #080;">&#40;</span>efrontier<span style="color: #080;">&#41;</span> <span style="color: #080;">=</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span><span style="color: #ff0000;">"Return"</span>, <span style="color: #ff0000;">"Risk"</span>, <span style="color: #ff0000;">"%Stocks"</span>, <span style="color: #ff0000;">"%Bills"</span>, <span style="color: #ff0000;">"%Bonds"</span>, <span style="color: #ff0000;">"%Gold"</span><span style="color: #080;">&#41;</span>
&nbsp;
	<a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/return.html"><span style="color: #0000FF; font-weight: bold;">return</span></a><span style="color: #080;">&#40;</span>efrontier<span style="color: #080;">&#41;</span>
<span style="color: #080;">&#125;</span>
&nbsp;
<span style="color: #228B22;">############################################################</span>
<span style="color: #228B22;"># charts</span>
<span style="color: #228B22;">############################################################</span>
&nbsp;
plot_efrontier <span style="color: #080;">&lt;-</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/function.html"><span style="color: #0000FF; font-weight: bold;">function</span></a> <span style="color: #080;">&#40;</span>efrontier, returns, sds, apoints, <a href="http://astrostatistics.psu.edu/su07/R/html/stats/html/title.html"><span style="color: #0000FF; font-weight: bold;">title</span></a><span style="color: #080;">&#41;</span> <span style="color: #080;">&#123;</span>
&nbsp;
     ggplot<span style="color: #080;">&#40;</span><span style="color: #0000FF; font-weight: bold;">data</span><span style="color: #080;">=</span>efrontier, aes<span style="color: #080;">&#40;</span>x<span style="color: #080;">=</span>Risk, y<span style="color: #080;">=</span>Return<span style="color: #080;">&#41;</span><span style="color: #080;">&#41;</span> <span style="color: #080;">+</span>
          theme_bw<span style="color: #080;">&#40;</span><span style="color: #080;">&#41;</span> <span style="color: #080;">+</span>
	  geom_line<span style="color: #080;">&#40;</span>size<span style="color: #080;">=</span><span style="color: #ff0000;">1.4</span><span style="color: #080;">&#41;</span> <span style="color: #080;">+</span>
	  geom_point<span style="color: #080;">&#40;</span><span style="color: #0000FF; font-weight: bold;">data</span><span style="color: #080;">=</span>apoints, aes<span style="color: #080;">&#40;</span>x<span style="color: #080;">=</span>Risk, y<span style="color: #080;">=</span>Return<span style="color: #080;">&#41;</span><span style="color: #080;">&#41;</span> <span style="color: #080;">+</span>		
	  scale_x_continuous<span style="color: #080;">&#40;</span>limits<span style="color: #080;">=</span><a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span><span style="color: #ff0000;">1</span>,<span style="color: #ff0000;">24</span><span style="color: #080;">&#41;</span><span style="color: #080;">&#41;</span> <span style="color: #080;">+</span>
	  ggtitle<span style="color: #080;">&#40;</span><a href="http://astrostatistics.psu.edu/su07/R/html/stats/html/title.html"><span style="color: #0000FF; font-weight: bold;">title</span></a><span style="color: #080;">&#41;</span> <span style="color: #080;">+</span>
	  annotate<span style="color: #080;">&#40;</span><span style="color: #ff0000;">"text"</span>, apoints<span style="color: #080;">&#91;</span><span style="color: #ff0000;">1</span>,<span style="color: #ff0000;">1</span><span style="color: #080;">&#93;</span>, apoints<span style="color: #080;">&#91;</span><span style="color: #ff0000;">1</span>,<span style="color: #ff0000;">2</span><span style="color: #080;">&#93;</span>,label<span style="color: #080;">=</span><span style="color: #ff0000;">" stocks"</span>, hjust<span style="color: #080;">=</span><span style="color: #ff0000;"></span><span style="color: #080;">&#41;</span> <span style="color: #080;">+</span>
	  annotate<span style="color: #080;">&#40;</span><span style="color: #ff0000;">"text"</span>, apoints<span style="color: #080;">&#91;</span><span style="color: #ff0000;">2</span>,<span style="color: #ff0000;">1</span><span style="color: #080;">&#93;</span>, apoints<span style="color: #080;">&#91;</span><span style="color: #ff0000;">2</span>,<span style="color: #ff0000;">2</span><span style="color: #080;">&#93;</span>,label<span style="color: #080;">=</span><span style="color: #ff0000;">" bills"</span>, hjust<span style="color: #080;">=</span><span style="color: #ff0000;"></span><span style="color: #080;">&#41;</span> <span style="color: #080;">+</span>
	  annotate<span style="color: #080;">&#40;</span><span style="color: #ff0000;">"text"</span>, apoints<span style="color: #080;">&#91;</span><span style="color: #ff0000;">3</span>,<span style="color: #ff0000;">1</span><span style="color: #080;">&#93;</span>, apoints<span style="color: #080;">&#91;</span><span style="color: #ff0000;">3</span>,<span style="color: #ff0000;">2</span><span style="color: #080;">&#93;</span>,label<span style="color: #080;">=</span><span style="color: #ff0000;">" bonds"</span>, hjust<span style="color: #080;">=</span><span style="color: #ff0000;"></span><span style="color: #080;">&#41;</span> <span style="color: #080;">+</span>
	  annotate<span style="color: #080;">&#40;</span><span style="color: #ff0000;">"text"</span>, apoints<span style="color: #080;">&#91;</span><span style="color: #ff0000;">4</span>,<span style="color: #ff0000;">1</span><span style="color: #080;">&#93;</span>, apoints<span style="color: #080;">&#91;</span><span style="color: #ff0000;">4</span>,<span style="color: #ff0000;">2</span><span style="color: #080;">&#93;</span>,label<span style="color: #080;">=</span><span style="color: #ff0000;">" gold"</span>, hjust<span style="color: #080;">=</span><span style="color: #ff0000;"></span><span style="color: #080;">&#41;</span> <span style="color: #080;">+</span>
	  annotate<span style="color: #080;">&#40;</span><span style="color: #ff0000;">"text"</span>, <span style="color: #ff0000;">19</span>,<span style="color: #ff0000;">0.3</span>,label<span style="color: #080;">=</span><span style="color: #ff0000;">"streeteye.com"</span>, hjust<span style="color: #080;">=</span><span style="color: #ff0000;"></span>, alpha<span style="color: #080;">=</span><span style="color: #ff0000;">0.5</span><span style="color: #080;">&#41;</span>
&nbsp;
<span style="color: #080;">&#125;</span>
&nbsp;
plot_transitionmap <span style="color: #080;">&lt;-</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/function.html"><span style="color: #0000FF; font-weight: bold;">function</span></a> <span style="color: #080;">&#40;</span>efrontier, returns, sds<span style="color: #080;">&#41;</span> <span style="color: #080;">&#123;</span>
&nbsp;
	<span style="color: #228B22;"># define colors</span>
	dvblue <span style="color: #080;">=</span> <span style="color: #ff0000;">"#000099"</span>
	dvred <span style="color: #080;">=</span> <span style="color: #ff0000;">"#e41a1c"</span>
	dvgreen <span style="color: #080;">=</span> <span style="color: #ff0000;">"#4daf4a"</span>
	dvpurple <span style="color: #080;">=</span> <span style="color: #ff0000;">"#984ea3"</span>
	dvorange <span style="color: #080;">=</span> <span style="color: #ff0000;">"#ff7f00"</span>
	dvyellow <span style="color: #080;">=</span> <span style="color: #ff0000;">"#ffff33"</span>
	dvgray<span style="color: #080;">=</span><span style="color: #ff0000;">"#666666"</span>
&nbsp;
	efrontier.<span style="">m</span> <span style="color: #080;">=</span> melt<span style="color: #080;">&#40;</span>efrontier, id <span style="color: #080;">=</span><span style="color: #ff0000;">'Risk'</span><span style="color: #080;">&#41;</span>
&nbsp;
	ggplot<span style="color: #080;">&#40;</span><span style="color: #0000FF; font-weight: bold;">data</span><span style="color: #080;">=</span>efrontier.<span style="">m</span>, aes<span style="color: #080;">&#40;</span>x<span style="color: #080;">=</span>Risk, y<span style="color: #080;">=</span>value, colour<span style="color: #080;">=</span>variable, fill<span style="color: #080;">=</span>variable<span style="color: #080;">&#41;</span><span style="color: #080;">&#41;</span> <span style="color: #080;">+</span>
		theme_bw<span style="color: #080;">&#40;</span><span style="color: #080;">&#41;</span> <span style="color: #080;">+</span>
		theme<span style="color: #080;">&#40;</span>legend.<span style="">position</span><span style="color: #080;">=</span><span style="color: #ff0000;">"top"</span>, legend.<span style="">direction</span><span style="color: #080;">=</span><span style="color: #ff0000;">"horizontal"</span><span style="color: #080;">&#41;</span> <span style="color: #080;">+</span>
		ylab<span style="color: #080;">&#40;</span><span style="color: #ff0000;">'% Portfolio'</span><span style="color: #080;">&#41;</span> <span style="color: #080;">+</span>
		geom_area<span style="color: #080;">&#40;</span><span style="color: #080;">&#41;</span> <span style="color: #080;">+</span>
		scale_colour_manual<span style="color: #080;">&#40;</span><span style="color: #ff0000;">""</span>, breaks<span style="color: #080;">=</span><a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span><span style="color: #ff0000;">"%Stocks"</span>, <span style="color: #ff0000;">"%Bills"</span>, <span style="color: #ff0000;">"%Bonds"</span>,<span style="color: #ff0000;">"%Gold"</span><span style="color: #080;">&#41;</span>, values <span style="color: #080;">=</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span>dvblue,dvgreen,dvred,dvyellow<span style="color: #080;">&#41;</span>, <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/labels.html"><span style="color: #0000FF; font-weight: bold;">labels</span></a><span style="color: #080;">=</span><a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span><span style="color: #ff0000;">'%Stocks'</span>, <span style="color: #ff0000;">'%Bills'</span>,<span style="color: #ff0000;">'%Bonds'</span>,<span style="color: #ff0000;">'%Gold'</span><span style="color: #080;">&#41;</span><span style="color: #080;">&#41;</span> <span style="color: #080;">+</span>
		scale_fill_manual<span style="color: #080;">&#40;</span><span style="color: #ff0000;">""</span>, breaks<span style="color: #080;">=</span><a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span><span style="color: #ff0000;">"%Stocks"</span>, <span style="color: #ff0000;">"%Bills"</span>, <span style="color: #ff0000;">"%Bonds"</span>,<span style="color: #ff0000;">"%Gold"</span><span style="color: #080;">&#41;</span>, values <span style="color: #080;">=</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span>dvblue,dvgreen,dvred,dvyellow<span style="color: #080;">&#41;</span>, <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/labels.html"><span style="color: #0000FF; font-weight: bold;">labels</span></a><span style="color: #080;">=</span><a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span><span style="color: #ff0000;">'%Stocks'</span>, <span style="color: #ff0000;">'%Bills'</span>,<span style="color: #ff0000;">'%Bonds'</span>,<span style="color: #ff0000;">'%Gold'</span><span style="color: #080;">&#41;</span><span style="color: #080;">&#41;</span>
<span style="color: #228B22;">#		annotate("text", 16,-2.5,label="streeteye.com", hjust=0, alpha=0.5)</span>
&nbsp;
<span style="color: #080;">&#125;</span>
&nbsp;
<span style="color: #228B22;">#################################################################</span>
<span style="color: #228B22;"># Create some data</span>
<span style="color: #228B22;">#################################################################</span>
<span style="color: #228B22;"># sources:</span>
<span style="color: #228B22;"># http://pages.stern.nyu.edu/~adamodar/New_Home_Page/datafile/histretSP.html</span>
<span style="color: #228B22;"># http://www.onlygold.com/Info/Historical-Gold-Prices.asp</span>
<span style="color: #228B22;"># http://www.spdrgoldshares.com/usa/historical-data/</span>
<span style="color: #228B22;">#################################################################</span>
&nbsp;
<span style="color: #228B22;"># not used in abbreviated example, but useful for reporting</span>
startYear <span style="color: #080;">=</span> <span style="color: #ff0000;">1928</span>
endYear <span style="color: #080;">=</span> <span style="color: #ff0000;">2014</span>
YEARS <span style="color: #080;">=</span>startYear<span style="color: #080;">:</span>endYear
&nbsp;
<span style="color: #228B22;"># nominal returns</span>
<span style="color: #228B22;"># nominal returns</span>
SP500 <span style="color: #080;">=</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span><span style="color: #ff0000;">0.4381</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.083</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.2512</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.4384</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.0864</span>,<span style="color: #ff0000;">0.4998</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.0119</span>,<span style="color: #ff0000;">0.4674</span>,<span style="color: #ff0000;">0.3194</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.3534</span>,<span style="color: #ff0000;">0.2928</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.011</span>,
<span style="color: #080;">-</span><span style="color: #ff0000;">0.1067</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.1277</span>,<span style="color: #ff0000;">0.1917</span>,<span style="color: #ff0000;">0.2506</span>,<span style="color: #ff0000;">0.1903</span>,<span style="color: #ff0000;">0.3582</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.0843</span>,<span style="color: #ff0000;">0.052</span>,<span style="color: #ff0000;">0.057</span>,<span style="color: #ff0000;">0.183</span>,<span style="color: #ff0000;">0.3081</span>,<span style="color: #ff0000;">0.2368</span>,<span style="color: #ff0000;">0.1815</span>,
<span style="color: #080;">-</span><span style="color: #ff0000;">0.0121</span>,<span style="color: #ff0000;">0.5256</span>,<span style="color: #ff0000;">0.326</span>,<span style="color: #ff0000;">0.0744</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.1046</span>,<span style="color: #ff0000;">0.4372</span>,<span style="color: #ff0000;">0.1206</span>,<span style="color: #ff0000;">0.0034</span>,<span style="color: #ff0000;">0.2664</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.0881</span>,<span style="color: #ff0000;">0.2261</span>,<span style="color: #ff0000;">0.1642</span>,<span style="color: #ff0000;">0.124</span>,
<span style="color: #080;">-</span><span style="color: #ff0000;">0.0997</span>,<span style="color: #ff0000;">0.238</span>,<span style="color: #ff0000;">0.1081</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.0824</span>,<span style="color: #ff0000;">0.0356</span>,<span style="color: #ff0000;">0.1422</span>,<span style="color: #ff0000;">0.1876</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.1431</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.259</span>,<span style="color: #ff0000;">0.37</span>,<span style="color: #ff0000;">0.2383</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.0698</span>,<span style="color: #ff0000;">0.0651</span>,
<span style="color: #ff0000;">0.1852</span>,<span style="color: #ff0000;">0.3174</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.047</span>,<span style="color: #ff0000;">0.2042</span>,<span style="color: #ff0000;">0.2234</span>,<span style="color: #ff0000;">0.0615</span>,<span style="color: #ff0000;">0.3124</span>,<span style="color: #ff0000;">0.1849</span>,<span style="color: #ff0000;">0.0581</span>,<span style="color: #ff0000;">0.1654</span>,<span style="color: #ff0000;">0.3148</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.0306</span>,<span style="color: #ff0000;">0.3023</span>,
<span style="color: #ff0000;">0.0749</span>,<span style="color: #ff0000;">0.0997</span>,<span style="color: #ff0000;">0.0133</span>,<span style="color: #ff0000;">0.372</span>,<span style="color: #ff0000;">0.2268</span>,<span style="color: #ff0000;">0.331</span>,<span style="color: #ff0000;">0.2834</span>,<span style="color: #ff0000;">0.2089</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.0903</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.1185</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.2197</span>,<span style="color: #ff0000;">0.2836</span>,<span style="color: #ff0000;">0.1074</span>,
<span style="color: #ff0000;">0.0483</span>,<span style="color: #ff0000;">0.1561</span>,<span style="color: #ff0000;">0.0548</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.3655</span>,<span style="color: #ff0000;">0.2594</span>,<span style="color: #ff0000;">0.1482</span>,<span style="color: #ff0000;">0.021</span>,<span style="color: #ff0000;">0.1589</span>,<span style="color: #ff0000;">0.3215</span>,<span style="color: #ff0000;">0.1348</span><span style="color: #080;">&#41;</span>
&nbsp;
BILLS <span style="color: #080;">=</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span><span style="color: #ff0000;">0.0308</span>,<span style="color: #ff0000;">0.0316</span>,<span style="color: #ff0000;">0.0455</span>,<span style="color: #ff0000;">0.0231</span>,<span style="color: #ff0000;">0.0107</span>,<span style="color: #ff0000;">0.0096</span>,<span style="color: #ff0000;">0.0032</span>,<span style="color: #ff0000;">0.0018</span>,<span style="color: #ff0000;">0.0017</span>,<span style="color: #ff0000;">0.003</span>,<span style="color: #ff0000;">0.0008</span>,<span style="color: #ff0000;">0.0004</span>,
<span style="color: #ff0000;">0.0003</span>,<span style="color: #ff0000;">0.0008</span>,<span style="color: #ff0000;">0.0034</span>,<span style="color: #ff0000;">0.0038</span>,<span style="color: #ff0000;">0.0038</span>,<span style="color: #ff0000;">0.0038</span>,<span style="color: #ff0000;">0.0038</span>,<span style="color: #ff0000;">0.0057</span>,<span style="color: #ff0000;">0.0102</span>,<span style="color: #ff0000;">0.011</span>,<span style="color: #ff0000;">0.0117</span>,<span style="color: #ff0000;">0.0148</span>,
<span style="color: #ff0000;">0.0167</span>,<span style="color: #ff0000;">0.0189</span>,<span style="color: #ff0000;">0.0096</span>,<span style="color: #ff0000;">0.0166</span>,<span style="color: #ff0000;">0.0256</span>,<span style="color: #ff0000;">0.0323</span>,<span style="color: #ff0000;">0.0178</span>,<span style="color: #ff0000;">0.0326</span>,<span style="color: #ff0000;">0.0305</span>,<span style="color: #ff0000;">0.0227</span>,<span style="color: #ff0000;">0.0278</span>,<span style="color: #ff0000;">0.0311</span>,
<span style="color: #ff0000;">0.0351</span>,<span style="color: #ff0000;">0.039</span>,<span style="color: #ff0000;">0.0484</span>,<span style="color: #ff0000;">0.0433</span>,<span style="color: #ff0000;">0.0526</span>,<span style="color: #ff0000;">0.0656</span>,<span style="color: #ff0000;">0.0669</span>,<span style="color: #ff0000;">0.0454</span>,<span style="color: #ff0000;">0.0395</span>,<span style="color: #ff0000;">0.0673</span>,<span style="color: #ff0000;">0.0778</span>,<span style="color: #ff0000;">0.0599</span>,
<span style="color: #ff0000;">0.0497</span>,<span style="color: #ff0000;">0.0513</span>,<span style="color: #ff0000;">0.0693</span>,<span style="color: #ff0000;">0.0994</span>,<span style="color: #ff0000;">0.1122</span>,<span style="color: #ff0000;">0.143</span>,<span style="color: #ff0000;">0.1101</span>,<span style="color: #ff0000;">0.0845</span>,<span style="color: #ff0000;">0.0961</span>,<span style="color: #ff0000;">0.0749</span>,<span style="color: #ff0000;">0.0604</span>,<span style="color: #ff0000;">0.0572</span>,
<span style="color: #ff0000;">0.0645</span>,<span style="color: #ff0000;">0.0811</span>,<span style="color: #ff0000;">0.0755</span>,<span style="color: #ff0000;">0.0561</span>,<span style="color: #ff0000;">0.0341</span>,<span style="color: #ff0000;">0.0298</span>,<span style="color: #ff0000;">0.0399</span>,<span style="color: #ff0000;">0.0552</span>,<span style="color: #ff0000;">0.0502</span>,<span style="color: #ff0000;">0.0505</span>,<span style="color: #ff0000;">0.0473</span>,<span style="color: #ff0000;">0.0451</span>,
<span style="color: #ff0000;">0.0576</span>,<span style="color: #ff0000;">0.0367</span>,<span style="color: #ff0000;">0.0166</span>,<span style="color: #ff0000;">0.0103</span>,<span style="color: #ff0000;">0.0123</span>,<span style="color: #ff0000;">0.0301</span>,<span style="color: #ff0000;">0.0468</span>,<span style="color: #ff0000;">0.0464</span>,<span style="color: #ff0000;">0.0159</span>,<span style="color: #ff0000;">0.0014</span>,<span style="color: #ff0000;">0.0013</span>,<span style="color: #ff0000;">0.0003</span>,
<span style="color: #ff0000;">0.0005</span>,<span style="color: #ff0000;">0.0007</span>,<span style="color: #ff0000;">0.0005</span><span style="color: #080;">&#41;</span>
&nbsp;
BONDS<span style="color: #080;">=</span><a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span><span style="color: #ff0000;">0.0084</span>,<span style="color: #ff0000;">0.042</span>,<span style="color: #ff0000;">0.0454</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.0256</span>,<span style="color: #ff0000;">0.0879</span>,<span style="color: #ff0000;">0.0186</span>,<span style="color: #ff0000;">0.0796</span>,<span style="color: #ff0000;">0.0447</span>,<span style="color: #ff0000;">0.0502</span>,<span style="color: #ff0000;">0.0138</span>,<span style="color: #ff0000;">0.0421</span>,<span style="color: #ff0000;">0.0441</span>,
<span style="color: #ff0000;">0.054</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.0202</span>,<span style="color: #ff0000;">0.0229</span>,<span style="color: #ff0000;">0.0249</span>,<span style="color: #ff0000;">0.0258</span>,<span style="color: #ff0000;">0.038</span>,<span style="color: #ff0000;">0.0313</span>,<span style="color: #ff0000;">0.0092</span>,<span style="color: #ff0000;">0.0195</span>,<span style="color: #ff0000;">0.0466</span>,<span style="color: #ff0000;">0.0043</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.003</span>,
<span style="color: #ff0000;">0.0227</span>,<span style="color: #ff0000;">0.0414</span>,<span style="color: #ff0000;">0.0329</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.0134</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.0226</span>,<span style="color: #ff0000;">0.068</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.021</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.0265</span>,<span style="color: #ff0000;">0.1164</span>,<span style="color: #ff0000;">0.0206</span>,<span style="color: #ff0000;">0.0569</span>,<span style="color: #ff0000;">0.0168</span>,
<span style="color: #ff0000;">0.0373</span>,<span style="color: #ff0000;">0.0072</span>,<span style="color: #ff0000;">0.0291</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.0158</span>,<span style="color: #ff0000;">0.0327</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.0501</span>,<span style="color: #ff0000;">0.1675</span>,<span style="color: #ff0000;">0.0979</span>,<span style="color: #ff0000;">0.0282</span>,<span style="color: #ff0000;">0.0366</span>,<span style="color: #ff0000;">0.0199</span>,<span style="color: #ff0000;">0.0361</span>,
<span style="color: #ff0000;">0.1598</span>,<span style="color: #ff0000;">0.0129</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.0078</span>,<span style="color: #ff0000;">0.0067</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.0299</span>,<span style="color: #ff0000;">0.082</span>,<span style="color: #ff0000;">0.3281</span>,<span style="color: #ff0000;">0.032</span>,<span style="color: #ff0000;">0.1373</span>,<span style="color: #ff0000;">0.2571</span>,<span style="color: #ff0000;">0.2428</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.0496</span>,
<span style="color: #ff0000;">0.0822</span>,<span style="color: #ff0000;">0.1769</span>,<span style="color: #ff0000;">0.0624</span>,<span style="color: #ff0000;">0.15</span>,<span style="color: #ff0000;">0.0936</span>,<span style="color: #ff0000;">0.1421</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.0804</span>,<span style="color: #ff0000;">0.2348</span>,<span style="color: #ff0000;">0.0143</span>,<span style="color: #ff0000;">0.0994</span>,<span style="color: #ff0000;">0.1492</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.0825</span>,
<span style="color: #ff0000;">0.1666</span>,<span style="color: #ff0000;">0.0557</span>,<span style="color: #ff0000;">0.1512</span>,<span style="color: #ff0000;">0.0038</span>,<span style="color: #ff0000;">0.0449</span>,<span style="color: #ff0000;">0.0287</span>,<span style="color: #ff0000;">0.0196</span>,<span style="color: #ff0000;">0.1021</span>,<span style="color: #ff0000;">0.201</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.1112</span>,<span style="color: #ff0000;">0.0846</span>,<span style="color: #ff0000;">0.1604</span>,
<span style="color: #ff0000;">0.0297</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.091</span>,<span style="color: #ff0000;">0.1075</span><span style="color: #080;">&#41;</span>
&nbsp;
CPI<span style="color: #080;">=</span><a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span><span style="color: #080;">-</span><span style="color: #ff0000;">0.0115607</span>,<span style="color: #ff0000;">0.005848</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.0639535</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.0931677</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.1027397</span>,<span style="color: #ff0000;">0.0076336</span>,<span style="color: #ff0000;">0.0151515</span>,<span style="color: #ff0000;">0.0298507</span>,
<span style="color: #ff0000;">0.0144928</span>,<span style="color: #ff0000;">0.0285714</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.0277778</span>,<span style="color: #ff0000;"></span>,<span style="color: #ff0000;">0.0071429</span>,<span style="color: #ff0000;">0.0992908</span>,<span style="color: #ff0000;">0.0903226</span>,<span style="color: #ff0000;">0.0295858</span>,<span style="color: #ff0000;">0.0229885</span>,
<span style="color: #ff0000;">0.0224719</span>,<span style="color: #ff0000;">0.1813187</span>,<span style="color: #ff0000;">0.0883721</span>,<span style="color: #ff0000;">0.0299145</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.0207469</span>,<span style="color: #ff0000;">0.059322</span>,<span style="color: #ff0000;">0.06</span>,<span style="color: #ff0000;">0.0075472</span>,<span style="color: #ff0000;">0.0074906</span>,
<span style="color: #080;">-</span><span style="color: #ff0000;">0.0074349</span>,<span style="color: #ff0000;">0.0037453</span>,<span style="color: #ff0000;">0.0298507</span>,<span style="color: #ff0000;">0.0289855</span>,<span style="color: #ff0000;">0.0176056</span>,<span style="color: #ff0000;">0.017301</span>,<span style="color: #ff0000;">0.0136054</span>,<span style="color: #ff0000;">0.0067114</span>,<span style="color: #ff0000;">0.0133333</span>,
<span style="color: #ff0000;">0.0164474</span>,<span style="color: #ff0000;">0.0097087</span>,<span style="color: #ff0000;">0.0192308</span>,<span style="color: #ff0000;">0.0345912</span>,<span style="color: #ff0000;">0.0303951</span>,<span style="color: #ff0000;">0.0471976</span>,<span style="color: #ff0000;">0.0619718</span>,<span style="color: #ff0000;">0.0557029</span>,<span style="color: #ff0000;">0.0326633</span>,
<span style="color: #ff0000;">0.0340633</span>,<span style="color: #ff0000;">0.0870588</span>,<span style="color: #ff0000;">0.1233766</span>,<span style="color: #ff0000;">0.0693642</span>,<span style="color: #ff0000;">0.0486486</span>,<span style="color: #ff0000;">0.0670103</span>,<span style="color: #ff0000;">0.0901771</span>,<span style="color: #ff0000;">0.1329394</span>,<span style="color: #ff0000;">0.125163</span>,
<span style="color: #ff0000;">0.0892236</span>,<span style="color: #ff0000;">0.0382979</span>,<span style="color: #ff0000;">0.0379098</span>,<span style="color: #ff0000;">0.0394867</span>,<span style="color: #ff0000;">0.0379867</span>,<span style="color: #ff0000;">0.010979</span>,<span style="color: #ff0000;">0.0443439</span>,<span style="color: #ff0000;">0.0441941</span>,<span style="color: #ff0000;">0.046473</span>,
<span style="color: #ff0000;">0.0610626</span>,<span style="color: #ff0000;">0.0306428</span>,<span style="color: #ff0000;">0.0290065</span>,<span style="color: #ff0000;">0.0274841</span>,<span style="color: #ff0000;">0.026749</span>,<span style="color: #ff0000;">0.0253841</span>,<span style="color: #ff0000;">0.0332248</span>,<span style="color: #ff0000;">0.017024</span>,<span style="color: #ff0000;">0.016119</span>,
<span style="color: #ff0000;">0.0268456</span>,<span style="color: #ff0000;">0.0338681</span>,<span style="color: #ff0000;">0.0155172</span>,<span style="color: #ff0000;">0.0237691</span>,<span style="color: #ff0000;">0.0187949</span>,<span style="color: #ff0000;">0.0325556</span>,<span style="color: #ff0000;">0.0341566</span>,<span style="color: #ff0000;">0.0254065</span>,<span style="color: #ff0000;">0.0408127</span>,
<span style="color: #ff0000;">0.0009141</span>,<span style="color: #ff0000;">0.0272133</span>,<span style="color: #ff0000;">0.0149572</span>,<span style="color: #ff0000;">0.03</span>,<span style="color: #ff0000;">0.017</span>,<span style="color: #ff0000;">0.015</span>,<span style="color: #ff0000;">0.008</span><span style="color: #080;">&#41;</span>
&nbsp;
GOLD <span style="color: #080;">=</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span><span style="color: #ff0000;"></span>,<span style="color: #ff0000;"></span>,<span style="color: #ff0000;"></span>,<span style="color: #ff0000;"></span>,<span style="color: #ff0000;"></span>,<span style="color: #ff0000;">0.563618771</span>,<span style="color: #ff0000;">0.082920792</span>,
<span style="color: #ff0000;"></span>,<span style="color: #ff0000;"></span>,<span style="color: #ff0000;"></span>,<span style="color: #ff0000;"></span>,<span style="color: #ff0000;"></span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.014285714</span>,<span style="color: #ff0000;">0.028985507</span>,<span style="color: #ff0000;"></span>,
<span style="color: #ff0000;">0.028169014</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.006849315</span>,<span style="color: #ff0000;">0.027586207</span>,<span style="color: #ff0000;">0.026845638</span>,<span style="color: #ff0000;">0.124183007</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.023255814</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.035714286</span>,
<span style="color: #080;">-</span><span style="color: #ff0000;">0.00617284</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.00621118</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.0325</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.082687339</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.007042254</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.002836879</span>,<span style="color: #ff0000;">0.001422475</span>,
<span style="color: #ff0000;">0.001420455</span>,<span style="color: #ff0000;"></span>,<span style="color: #ff0000;"></span>,<span style="color: #ff0000;">0.035460993</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.02739726</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.004225352</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.002828854</span>,
<span style="color: #ff0000;">0.002836879</span>,<span style="color: #ff0000;">0.004243281</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.002816901</span>,<span style="color: #ff0000;">0.002824859</span>,<span style="color: #ff0000;">0.225352113</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.057471264</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.051219512</span>,
<span style="color: #ff0000;">0.146529563</span>,<span style="color: #ff0000;">0.431390135</span>,<span style="color: #ff0000;">0.667919799</span>,<span style="color: #ff0000;">0.725864012</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.242041683</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.03962955</span>,<span style="color: #ff0000;">0.204305898</span>,
<span style="color: #ff0000;">0.291744258</span>,<span style="color: #ff0000;">1.205670351</span>,<span style="color: #ff0000;">0.296078431</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.327618087</span>,<span style="color: #ff0000;">0.1175</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.149888143</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.189473684</span>,
<span style="color: #ff0000;">0.061688312</span>,<span style="color: #ff0000;">0.195412844</span>,<span style="color: #ff0000;">0.244563827</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.156937307</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.022308911</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.036907731</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.085577421</span>,
<span style="color: #080;">-</span><span style="color: #ff0000;">0.057057907</span>,<span style="color: #ff0000;">0.176426426</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.021697511</span>,<span style="color: #ff0000;">0.009784736</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.046511628</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.222086721</span>,<span style="color: #ff0000;">0.005748128</span>,
<span style="color: #ff0000;">0.005368895</span>,<span style="color: #080;">-</span><span style="color: #ff0000;">0.060637382</span>,<span style="color: #ff0000;">0.014120668</span>,<span style="color: #ff0000;">0.23960217</span>,<span style="color: #ff0000;">0.217359592</span>,<span style="color: #ff0000;">0.04397843</span>,<span style="color: #ff0000;">0.17768595</span>,
<span style="color: #ff0000;">0.231968811</span>,<span style="color: #ff0000;">0.319224684</span>,<span style="color: #ff0000;">0.043178411</span>,<span style="color: #ff0000;">0.250359299</span>,<span style="color: #ff0000;">0.292413793</span>,<span style="color: #ff0000;">0.089292067</span>,<span style="color: #ff0000;">0.082625735</span>,
<span style="color: #080;">-</span><span style="color: #ff0000;">0.273303167</span>,<span style="color: #ff0000;">0.00124533</span>
<span style="color: #080;">&#41;</span>
&nbsp;
<span style="color: #228B22;"># truncate here, e.g.</span>
<span style="color: #228B22;"># 1928 - 2014 - 87 years</span>
<span style="color: #228B22;"># 1946 - 2014 - 69 years</span>
&nbsp;
<span style="color: #228B22;">#SP500=SP500[19:87]</span>
<span style="color: #228B22;">#BILLS=BILLS[19:87]</span>
<span style="color: #228B22;">#BONDS=BONDS[19:87]</span>
<span style="color: #228B22;">#GOLD=GOLD[19:87]</span>
<span style="color: #228B22;">#CPI=CPI[19:87]</span>
&nbsp;
<span style="color: #228B22;"># 1972 - 2014 - 43 years</span>
<span style="color: #228B22;"># SP500=SP500[45:87]</span>
<span style="color: #228B22;"># BILLS=BILLS[45:87]</span>
<span style="color: #228B22;"># BONDS=BONDS[45:87]</span>
<span style="color: #228B22;"># GOLD=GOLD[45:87]</span>
<span style="color: #228B22;"># CPI=CPI[45:87]</span>
&nbsp;
<span style="color: #228B22;"># 1982 - 2014 - 33 years</span>
SP500<span style="color: #080;">=</span>SP500<span style="color: #080;">&#91;</span><span style="color: #ff0000;">55</span><span style="color: #080;">:</span><span style="color: #ff0000;">87</span><span style="color: #080;">&#93;</span>
BILLS<span style="color: #080;">=</span>BILLS<span style="color: #080;">&#91;</span><span style="color: #ff0000;">55</span><span style="color: #080;">:</span><span style="color: #ff0000;">87</span><span style="color: #080;">&#93;</span>
BONDS<span style="color: #080;">=</span>BONDS<span style="color: #080;">&#91;</span><span style="color: #ff0000;">55</span><span style="color: #080;">:</span><span style="color: #ff0000;">87</span><span style="color: #080;">&#93;</span>
GOLD<span style="color: #080;">=</span>GOLD<span style="color: #080;">&#91;</span><span style="color: #ff0000;">55</span><span style="color: #080;">:</span><span style="color: #ff0000;">87</span><span style="color: #080;">&#93;</span>
CPI<span style="color: #080;">=</span>CPI<span style="color: #080;">&#91;</span><span style="color: #ff0000;">55</span><span style="color: #080;">:</span><span style="color: #ff0000;">87</span><span style="color: #080;">&#93;</span>
&nbsp;
&nbsp;
<span style="color: #228B22;"># put into a data frame</span>
fnominal<span style="color: #080;">=</span><a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/data.frame.html"><span style="color: #0000FF; font-weight: bold;">data.<span style="">frame</span></span></a><span style="color: #080;">&#40;</span>stocks<span style="color: #080;">=</span>SP500, bills<span style="color: #080;">=</span>BILLS, bonds<span style="color: #080;">=</span>BONDS, gold<span style="color: #080;">=</span>GOLD, CPI<span style="color: #080;">=</span>CPI<span style="color: #080;">&#41;</span>
freal<span style="color: #080;">=</span><a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/data.frame.html"><span style="color: #0000FF; font-weight: bold;">data.<span style="">frame</span></span></a><span style="color: #080;">&#40;</span>stocks<span style="color: #080;">=</span><span style="color: #080;">&#40;</span><span style="color: #ff0000;">1</span><span style="color: #080;">+</span>SP500<span style="color: #080;">&#41;</span><span style="color: #080;">/</span><span style="color: #080;">&#40;</span><span style="color: #ff0000;">1</span><span style="color: #080;">+</span>CPI<span style="color: #080;">&#41;</span><span style="color: #080;">-</span><span style="color: #ff0000;">1</span>, bills<span style="color: #080;">=</span><span style="color: #080;">&#40;</span><span style="color: #ff0000;">1</span><span style="color: #080;">+</span>BILLS<span style="color: #080;">&#41;</span><span style="color: #080;">/</span><span style="color: #080;">&#40;</span><span style="color: #ff0000;">1</span><span style="color: #080;">+</span>CPI<span style="color: #080;">&#41;</span><span style="color: #080;">-</span><span style="color: #ff0000;">1</span>, bonds<span style="color: #080;">=</span><span style="color: #080;">&#40;</span><span style="color: #ff0000;">1</span><span style="color: #080;">+</span>BONDS<span style="color: #080;">&#41;</span><span style="color: #080;">/</span><span style="color: #080;">&#40;</span><span style="color: #ff0000;">1</span><span style="color: #080;">+</span>CPI<span style="color: #080;">&#41;</span><span style="color: #080;">-</span><span style="color: #ff0000;">1</span>, gold<span style="color: #080;">=</span><span style="color: #080;">&#40;</span><span style="color: #ff0000;">1</span><span style="color: #080;">+</span>GOLD<span style="color: #080;">&#41;</span><span style="color: #080;">/</span><span style="color: #080;">&#40;</span><span style="color: #ff0000;">1</span><span style="color: #080;">+</span>CPI<span style="color: #080;">&#41;</span><span style="color: #080;">-</span><span style="color: #ff0000;">1</span><span style="color: #080;">&#41;</span>
<span style="color: #228B22;">#freal=data.frame(stocks=SP500-CPI, bills=BILLS-CPI, bonds=BONDS-CPI, gold=GOLD-CPI)</span>
&nbsp;
<span style="color: #228B22;"># compute real return means</span>
realreturns <span style="color: #080;">=</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/apply.html"><span style="color: #0000FF; font-weight: bold;">apply</span></a><span style="color: #080;">&#40;</span>freal, <span style="color: #ff0000;">2</span>, <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/mean.html"><span style="color: #0000FF; font-weight: bold;">mean</span></a><span style="color: #080;">&#41;</span>
realreturnspct <span style="color: #080;">=</span> realreturns<span style="color: #080;">*</span><span style="color: #ff0000;">100</span>
<span style="color: #228B22;"># print them</span>
realreturnspct
&nbsp;
<span style="color: #228B22;"># compute real return volatility (standard deviation of real returns)</span>
realsds <span style="color: #080;">=</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/apply.html"><span style="color: #0000FF; font-weight: bold;">apply</span></a><span style="color: #080;">&#40;</span>freal, <span style="color: #ff0000;">2</span>, <span style="color: #0000FF; font-weight: bold;">sd</span><span style="color: #080;">&#41;</span>
realsdspct <span style="color: #080;">=</span> realsds<span style="color: #080;">*</span><span style="color: #ff0000;">100</span>
<span style="color: #228B22;"># print them</span>
realsdspct
&nbsp;
maxret <span style="color: #080;">&lt;-</span> runlp<span style="color: #080;">&#40;</span>freal<span style="color: #080;">&#41;</span>
minvol <span style="color: #080;">&lt;-</span> runqp<span style="color: #080;">&#40;</span>freal,<span style="color: #ff0000;"></span><span style="color: #080;">&#41;</span>
&nbsp;
<span style="color: #228B22;"># generate a sequence of 50 evenly spaced returns between min var return and max return</span>
efrontier <span style="color: #080;">=</span> loopqp<span style="color: #080;">&#40;</span>minvol, maxret, <span style="color: #ff0000;">50</span><span style="color: #080;">&#41;</span>
&nbsp;
apoints <span style="color: #080;">&lt;-</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/data.frame.html"><span style="color: #0000FF; font-weight: bold;">data.<span style="">frame</span></span></a><span style="color: #080;">&#40;</span>realsdspct<span style="color: #080;">&#41;</span>
apoints$returns <span style="color: #080;">&lt;-</span> realreturnspct
<a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/names.html"><span style="color: #0000FF; font-weight: bold;">names</span></a><span style="color: #080;">&#40;</span>apoints<span style="color: #080;">&#41;</span> <span style="color: #080;">=</span> <a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span><span style="color: #ff0000;">"Risk"</span>, <span style="color: #ff0000;">"Return"</span><span style="color: #080;">&#41;</span>
&nbsp;
plot_efrontier<span style="color: #080;">&#40;</span>efrontier, realreturnspct, realsdspct, apoints, <span style="color: #ff0000;">"Efficient Frontier, 1946-2014"</span><span style="color: #080;">&#41;</span>
keep<span style="color: #080;">=</span><a href="http://astrostatistics.psu.edu/su07/R/html/graphics/html/c.html"><span style="color: #0000FF; font-weight: bold;">c</span></a><span style="color: #080;">&#40;</span><span style="color: #ff0000;">"Risk"</span>, <span style="color: #ff0000;">"%Stocks"</span>,<span style="color: #ff0000;">"%Bills"</span>,<span style="color: #ff0000;">"%Bonds"</span>,<span style="color: #ff0000;">"%Gold"</span><span style="color: #080;">&#41;</span>
plot_transitionmap<span style="color: #080;">&#40;</span>efrontier<span style="color: #080;">&#91;</span>keep<span style="color: #080;">&#93;</span>, realreturnspct, realsdspct<span style="color: #080;">&#41;</span></pre>
      </td>
    </tr>
  </table>
</div>